define(["base","app/commonApp"],function(e,t){var r=null;var a={processing:true,serverSide:true,searching:false,ordering:false,lengthChange:false,pagingType:"full_numbers",ajax:{url:$.path+"/api/portal/resource/findResResourceByPage",type:"get",contentType:"application/json",data:function(r){t.gridPageFliter(r);var a=e.form.getParams($("#search-form"));var n;if($.cookie("dssgUserInfo")){var i=$.cookie("dssgUserInfo");var s=JSON.parse(i).loginUserProfileDTO.currentEquipment.token}if(a){n=$.extend({equipment:s?s:"0",page:r.page,size:r.size},a)}return JSON.stringify(n)}},columns:[{data:"id",sWidth:"5%"},{data:"resName",sWidth:"15%"},{data:"resCode",sWidth:"15%"},{data:"themeName",sWidth:"14%"},{data:"industryTypeName",sWidth:"14%"},{data:"resTypeName",sWidth:"14%"},{data:"publishDept",sWidth:"11%"},{data:"hot",sWidth:"10%"}],columnDefs:[{render:function(e,t,r,a){return"<div class='checkboxWrapper'><input type='checkbox' name='cb' value='"+r.id+"' class='cb' cid='"+r.id+"'/></div>"},targets:0},{render:function(e,t,r,a){if(r.resName){var n="";if(r.resName.length>10){n=r.resName.substr(0,10)+"..."}else{n=r.resName}return"<div title='"+r.resName+"'>"+n+"</div>"}else{return"--"}},targets:1},{render:function(e,t,r,a){if(r.resCode){var n="";if(r.resCode.length>10){n=r.resCode.substr(0,10)+"..."}else{n=r.resCode}return"<div class='handCursor' title='"+r.resCode+"'>"+n+"</div>"}else{return"--"}},targets:2},{render:function(e,t,r,a){if(r.themeName){var n="";if(r.themeName.length>10){n=r.themeName.substr(0,10)+"..."}else{n=r.themeName}return"<div class='handCursor' title='"+r.themeName+"'>"+n+"</div>"}else{return"--"}},targets:3},{render:function(e,t,r,a){if(r.publishDept){var n="";if(r.industryTypeName.length>10){n=r.industryTypeName.substr(0,10)+"..."}else{n=r.industryTypeName}return"<div class='handCursor' title='"+r.industryTypeName+"'>"+n+"</div>"}else{return"--"}},targets:4},{render:function(e,t,r,a){if(r.publishDept){var n="";if(r.publishDept.length>10){n=r.publishDept.substr(0,10)+"..."}else{n=r.publishDept}return"<div class='handCursor' title='"+r.publishDept+"'>"+n+"</div>"}else{return"--"}},targets:6},{render:function(e,t,r,a){switch(r.hot){case"0":return"否";break;case"1":return"是";break}},targets:7}],drawCallback:function(r){e.selectAll($("#cball"),$(".cb"),function(){t.checkByGridButton($(".cb"))})}};var n=function(){r=e.datatables({container:$("#hot"),option:a,filter:t.gridFilter})};function i(e){var t="<option value='-1'>*请选择*</option>";$.each(e.data,function(e,r){t+="<option value='"+r.id+"'>"+r.text+"</option>"});return t}function s(){e.ajax({url:$.base+"/json/resType.json",type:"get",success:function(e){$("#resType").html(i(e))}})}function o(){e.ajax({url:$.path+"/api/sysBussinessDictionary/findDictionaryByType",data:{name:"themeType",type:1},type:"post",success:function(e){if(JSON.stringify(e.data)=="{}"){var t="<option value='-1'>*请选择*</option>";$("#themePanels").html(t)}else{var t="<option value='-1'>*请选择*</option>";var r=e.data.themeType;$.each(r,function(e,r){t+="<option value='"+r.id+"'>"+r.label+"</option>"});$("#themePanels").html(t)}}})}function u(){e.ajax({url:$.base+"/json/popularRecommend.json",type:"get",success:function(e){$("#popularRecommend").html(i(e))}})}var c=function(){$("#search").on("click",function(){t.search(r)})};var l=function(){$("#reset").on("click",function(){t.reset($("#search-form"),r)})};var d=function(){var a={cid:$(".ui-grid .cb:checked").attr("cid")};var n=e.modal({width:600,height:100,label:"推荐设置",url:"../html/portalManage/modify.html",buttons:[{label:"保存",cls:"btn btn-info",clickEvent:function(){e.form.validate({form:$("#form"),checkAll:true,passCallback:function(){var a=e.form.getParams($("#form"));if(a){t.submit({url:"/api/portal/resource/updateResource",params:a,type:"post",callback:function(){t.search(r)}});n.hide()}}})}},{label:"重置",cls:"btn btn-warning",clickEvent:function(){t.reset($("#form"))}}]})};var p=function(){$(".ui-grid-buttonbar .modify").on("click",function(){if($(this).hasClass("disabled")){return}else{d()}})};return{main:function(){n();s();o();u();c();l();p()}}});