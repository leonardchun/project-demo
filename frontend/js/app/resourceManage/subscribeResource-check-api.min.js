define(["base","app/commonApp"],function(e,a){var t=null,s=null,n=null,r=null,o=null;var i=$(".modal").attr("id");var l="";var c=function(){var e="f37acc0df62e41b7996f05094d933789";$.ajax({url:$.path+"/api/subscribeResource/getSubscribeById?id="+e,type:"get",async:false,success:function(e){if(e.success=true&&e.data){var a="";switch(e.data.resType){case"1":a="DATA";break;case"2":a="DOC";break;case"3":a="API";break;default:a="其他";break}$.each(e.data,function(e,t){if(e=="resType"){$("#applyMsg .resType").html(a)}else{$("#applyMsg ."+e).html(t)}})}}})};function d(){var e="f37acc0df62e41b7996f05094d933789";$.ajax({url:$.path+"/api/resCatalog/findResourceByID?id="+e,type:"get",success:function(e){if(e&&e.data){if(null!=e.data.filePath){$(".ui-page-headingImage").attr("src",e.data.filePath)}$(".ui-page-title .resName").html(e.data.resName);$.each(e.data,function(e,a){var t="",s="";$("#resMsg ."+e).html(a);if(e=="resType"){switch(a){case"1":t="DATA";break;case"2":t="DOC";break;case"3":t="API";break;case"4":t="其他";break}$("#resMsg .resType").html(t)}if(e=="resLevel"){switch(a){case"1":s="部分共享";break;case"2":s="全部共享";break}$("#resMsg .resLevel").html(s)}})}}})}function f(){var e="f37acc0df62e41b7996f05094d933789";$.ajax({url:$.path+"/api/resCatalog/findResourceByID?id="+e,type:"get",success:function(e){if(e.data&&e.data.apiJson){var a=JSON.parse(e.data.apiJson);var t="",s="";$.each(a.requestParams,function(e,a){var s="";if(a.mandatory=="0"){s="否"}else{s="是"}t+="<td>"+a.name+"</td><td>"+a.type+"</td>"+"<td>"+s+"</td><td>"+a.desc+"</td>"});$.each(a.responseStruct,function(e,a){var t="";if(a.notNull=="0"){t="否"}else{t="是"}s+="<td>"+a.name+"</td><td>"+a.type+"</td>"+"<td>"+t+"</td><td>"+a.desc+"</td>"});$("#requestParams tbody").html("<tr>"+t+"</tr>");$("#responseParams tbody").html("<tr>"+s+"</tr>")}}})}function u(){var e="";var a="f37acc0df62e41b7996f05094d933789";$.ajax({url:$.path+"/api/resCatalog/findResourceByID?id="+a,type:"get",async:false,success:function(a){if(a.data&&a.data.length>0){var t=JSON.parse(a.data.apiJson);if(t.requestParams&&t.requestParams.length>0){debugger;$.each(t.requestParams,function(a,t){e+="<option value='"+t.type+"'>"+t.name+"</option>"})}}}});return e}function p(e){var a="";$.ajax({url:"../json/checkJson/dataMsg.json",type:"get",async:false,success:function(t){if(t.data&&t.data.length>0){$.each(t.data,function(t,s){if(s.id==e){a+="<option value='"+s.id+"' selected>"+s.name+"</option>"}else{a+="<option value='"+s.id+"'>"+s.name+"</option>"}})}}});return a}function h(e){var a="";$.ajax({url:"../json/keywords/keyword.json",type:"get",async:false,success:function(t){if(t.data&&t.data.length>0){$.each(t.data,function(t,s){if(s.id==e){a+="<option value='"+s.id+"' selected content='"+s.content+"'>"+s.name+"</option>"}else{a+="<option value='"+s.id+"' content='"+s.content+"'>"+s.name+"</option>"}})}}});return a}function m(e){var a="";$.ajax({url:"../json/checkJson/compareSymbol.json",type:"get",async:false,success:function(t){if(t&&t.length>0){$.each(t,function(t,s){if(s.id==e){a+="<option value='"+s.id+"' selected  compareValue='"+s.compareValue+"'>"+s.name+"</option>"}else{a+="<option value='"+s.id+"' compareValue='"+s.content+"'>"+s.name+"</option>"}})}}});return a}var g={processing:true,serverSide:false,searching:false,ordering:false,lengthChange:false,paging:false,info:false,data:[],columns:[{data:"columnName",sWidth:"20%"},{data:"columnType",sWidth:"20%"},{data:"strategyName",sWidth:"20%"},{data:"strategyContent",sWidth:"20%"},{data:"operate",sWidth:"20%"}],columnDefs:[{render:function(e,a,t,s){return"<select class='form-control'>"+u()+"</select>"},targets:0},{render:function(e,a,t,s){return"<select class='form-control strategy'>"+h(t.strategyName)+"<option value='-1' class='createStrategy'>新建一个策略</option></select>"},targets:2},{render:function(e,a,t,s){return"<button class='btn btn-link delete del1'><i class='fa fa-trash-o'></i></button>"},targets:4}],drawCallback:function(e){$(".strategy").off().on("change",function(){if($(this).val()!=-1){var e=$(this).fsind("option:selected").attr("content");$(this).parent("td").next().html(e)}else{W()}});w();x()}};var y={processing:true,serverSide:false,searching:false,ordering:false,lengthChange:false,paging:false,info:false,data:[],columns:[{data:"resName",sWidth:"14%"},{data:"dataName",sWidth:"14%"},{data:"dataType",sWidth:"14%"},{data:"fieldName",sWidth:"14%"},{data:"strategyName",sWidth:"14%"},{data:"content",sWidth:"20%"},{data:"operate",sWidth:"10%"}],columnDefs:[{render:function(e,a,t,s){return"<select class='form-control'>"+p(t.dataName)+"</select>"},targets:1},{render:function(e,a,t,s){return"<select class='form-control strategy'>"+h(t.strategyName)+"<option value='-1' class='createStrategy'>新建一个策略</option></select>"},targets:4},{render:function(e,a,t,s){return"<button class='btn btn-link delete del1'><i class='fa fa-trash-o'></i></button>"},targets:6}],drawCallback:function(e){$(".strategy").off().on("change",function(){if($(this).val()!=-1){var e=$(this).find("option:selected").attr("content");$(this).parent("td").next().html(e)}else{W()}});w();x()}};var b={processing:true,serverSide:false,searching:false,ordering:false,lengthChange:false,paging:false,info:false,ajax:{url:"../json/checkJson/dataFilter.json",type:"get"},columns:[{data:"resName",sWidth:"15%"},{data:"dataName",sWidth:"15%"},{data:"dataType",sWidth:"15%"},{data:"fieldName",sWidth:"15%"},{data:"compare",sWidth:"10%"},{data:"compareValue",sWidth:"20%"},{data:"operate",sWidth:"10%"}],columnDefs:[{render:function(e,a,t,s){return"<select class='form-control dataItem'>"+p(t.dataName)+"</select>"},targets:1},{render:function(e,a,t,s){return"<select class='form-control compare'>"+m(t.compare)+"</select>"},targets:4},{render:function(e,a,t,s){if(t.compareValue!=undefined){return"<input type='text' class='form-control' value='"+t.compareValue+"'>"}else{return"<input type='text' class='form-control' value=''>"}},targets:5},{render:function(e,a,t,s){return"<button class='btn btn-link delete del2'><i class='fa fa-trash-o'></i></button>"},targets:6}],drawCallback:function(e){$("#data_filter .dataItem").off().on("click",function(){});$(".compare").off().on("change",function(){if($(this).val()!=-1){var e=$(this).find("option:selected").attr("compareValue");$(this).parent("td").next().html(e)}});w();x()}};var v={processing:true,serverSide:false,searching:false,ordering:false,lengthChange:false,paging:false,info:false,ajax:{url:"../json/checkJson/dataDesensitization.json",type:"get"},columns:[{data:"resName",sWidth:"16%"},{data:"dataName",sWidth:"16%"},{data:"dataType",sWidth:"16%"},{data:"fieldName",sWidth:"16%"},{data:"showRule",sWidth:"25%"},{data:"operate",sWidth:"11%"}],columnDefs:[{render:function(e,a,t,s){return"<select class='form-control'>"+p(t.dataName)+"</select>"},targets:1},{render:function(e,a,t,s){return"<span style='display:inline-block;margin-right:7px'><select class='form-control'><option value='1'>隐藏</option><option value='2'>保留</option></select></span>"+"<span style='display:inline-block;width:50px;position:relative;top:-1px'><input type='text' class='form-control'></span><span style='margin:0 5px'>到</span>"+"<span style='display:inline-block;width:50px;position:relative;top:-1px'><input type='text' class='form-control'></span><span style='margin:0 5px'>位</span>"},targets:4},{render:function(e,a,t,s){return"<button class='btn btn-link delete del3'><i class='fa fa-trash-o'></i></button>"},targets:5}],drawCallback:function(e){w();x()}};var k={processing:true,serverSide:false,searching:false,ordering:false,lengthChange:false,paging:false,info:false,ajax:{url:"../json/checkJson/dataTransform.json",type:"get"},columns:[{data:"resName",sWidth:"15%"},{data:"dataName",sWidth:"15%"},{data:"dataType",sWidth:"15%"},{data:"fieldName",sWidth:"15%"},{data:"content",sWidth:"15%"},{data:"replace",sWidth:"15%"},{data:"operate",sWidth:"10%"}],columnDefs:[{render:function(e,a,t,s){return"<select class='form-control dataItem'>"+p(t.dataName)+"</select>"},targets:1},{render:function(e,a,t,s){return"<input type='text' class='form-control'>"},targets:4},{render:function(e,a,t,s){return"<input type='text' class='form-control'>"},targets:5},{render:function(e,a,t,s){return"<button class='btn btn-link delete del4'><i class='fa fa-trash-o'></i></button>"},targets:6}],drawCallback:function(e){w();x()}};var N=function(a,i,l){var c;c=e.datatables({container:a,option:i});switch(l){case 1:t=c;break;case 2:s=c;break;case 3:n=c;break;case 4:r=c;break;case 5:o=c;break}};var W=function(){var t=e.modal({label:"新建策略",width:500,height:200,url:"../html/systemManage/keywordsFilter/create.html",drag:true,buttons:[{label:"保存",cls:"btn btn-info",clickEvent:function(){e.form.validate({form:$("#form"),checkAll:true,passCallback:function(){r.reload()}})}},{label:"重置",cls:"btn btn-warning",clickEvent:function(){a.reset($("#form"))}}]})};function w(){$(".add").off().on("click",function(){var e=$(this).attr("data-key");var a=[{resName:"1"},{dataName:"11"},{dataType:"1"},{fieldName:"1"},{strategyName:"1"},{content:"1"},{operate:"1"}];var i=[{resName:"1"},{dataName:"11"},{dataType:"1"},{fieldName:"1"},{strategyName:"1"},{content:"1"},{operate:"1"}];var l=[{resName:"1"},{dataName:"11"},{dataType:"1"},{fieldName:"1"},{strategyName:"1"},{content:"1"},{operate:"1"}];var c=[{resName:"1"},{dataName:"11"},{dataType:"1"},{fieldName:"1"},{strategyName:"1"},{content:"1"},{operate:"1"}];switch(e){case"0":t.addRow(a);break;case"1":s.addRow(a);break;case"2":n.addRow(a);break;case"3":r.addRow(a);break;case"4":o.addRow(a);break}})}function x(){$(".delete").off().on("click",function(){if($(this).hasClass("del1")){if($(this).parents("table").hasClass("sensitive_word_filter")){t.deleteRow(this)}else{s.deleteRow(this)}}else if($(this).hasClass("del2")){n.deleteRow(this)}else if($(this).hasClass("del3")){r.deleteRow(this)}else{o.deleteRow(this)}})}return{main:function(){c();d();f();N($("#sensitive_word_filter"),g,1);N($("#sensitive_word_filter_1"),y,2);N($("#data_filter"),b,3);N($("#data_desensitization"),v,4);N($("#data_transform"),k,5)}}});