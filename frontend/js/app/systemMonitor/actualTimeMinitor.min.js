define(["base","app/commonApp","echarts"],function(a,e,t){var r=["#20a8d8","#ef4900"];var n=["#00acee","#00acee","#ff8e8e","#faba3c"];var i=null;var s={processing:true,serverSide:true,searching:false,ordering:false,lengthChange:false,bPaginate:false,info:false,pagingType:"full_numbers",ajax:{url:$.path+"/api/sysMonitoring/getHotPublishResourceRanking",type:"get",contentType:"application/json",data:function(a){var e={timeFlag:$("#p3 .active").attr("type")=="today"?"0":"1",type:$("#grid_status .active").attr("key")};var t=$.extend(e,{page:0,size:10});return t}},columns:[{data:"resourceName",sWidth:"25%"},{data:"heatNum",sWidth:"25%"},{data:"subscriptionEquipmentNum",sWidth:"25%"},{data:"recordNum",sWidth:"25%"}],drawCallback:function(a){}};var o={processing:true,serverSide:true,searching:false,ordering:false,lengthChange:false,bPaginate:false,info:false,pagingType:"full_numbers",ajax:{url:$.path+"/api/sysMonitoring/getHotPublishResourceRanking",type:"get",contentType:"application/json",data:function(a){var e={timeFlag:$("#p3 .active").attr("type")=="today"?"0":"1",type:$("#grid_status .active").attr("key")};var t=$.extend(e,{page:0,size:10});return t}},columns:[{data:"resourceName",sWidth:"25%"},{data:"heatNum",sWidth:"25%"},{data:"subscriptionEquipmentNum",sWidth:"25%"},{data:"calculateValue",sWidth:"25%"}],drawCallback:function(a){}};var l={processing:true,serverSide:true,searching:false,ordering:false,lengthChange:false,bPaginate:false,info:false,pagingType:"full_numbers",ajax:{url:$.path+"/api/sysMonitoring/getHotPublishResourceRanking",type:"get",contentType:"application/json",data:function(a){var e={timeFlag:$("#p3 .active").attr("type")=="today"?"0":"1",type:$("#grid_status .active").attr("key")};var t=$.extend(e,{page:0,size:10});return t}},columns:[{data:"resourceName",sWidth:"25%"},{data:"heatNum",sWidth:"25%"},{data:"subscriptionEquipmentNum",sWidth:"25%"},{data:"recordNum",sWidth:"25%"}],drawCallback:function(a){}};var c=function(e){if(!e||e=="1"){i=a.datatables({container:$("#example1"),option:s})}else if(e=="2"){i=a.datatables({container:$("#example2"),option:o})}else if(e=="3"){i=a.datatables({container:$("#example3"),option:l})}a.scroll({container:$(".ui-panel-gridbar")})};self.setSwitch=function(){$("#p3 li").on("click",function(){var a=$("#grid_status li.active").attr("key");c(a)});$("#grid_status li").on("click",function(){var a=$(this).attr("key");if(a=="1"){$("#fileContent").hide();$("#apiContent").hide();$("#dataContent").show()}else if(a=="2"){$("#dataContent").hide();$("#apiContent").hide();$("#fileContent").show()}else if(a=="3"){$("#dataContent").hide();$("#fileContent").hide();$("#apiContent").show()}c(a)})};var u={color:r,legend:{left:"center",data:[{name:"流入",textStyle:{color:"#333"}},{name:"流出",textStyle:{color:"#333"}}]},tooltip:{trigger:"axis",axisPointer:{animation:false}},xAxis:{type:"category",data:[],boundaryGap:false},yAxis:{type:"value",boundaryGap:[0,0],splitLine:{show:true,lineStyle:{color:"#c0c0c0"}}},series:[{name:"流入",type:"line",showSymbol:false,hoverAnimation:false,smooth:true,areaStyle:{normal:{color:"#20a8d8",opacity:"0.2"}},data:[]},{name:"流出",type:"line",smooth:true,showSymbol:false,hoverAnimation:false,areaStyle:{normal:{color:"#d7eff8"}},data:[]}]};var d={color:["#2fb6e6","#faba3c","#67c2ef","#ff8e8e","#00acee"],tooltip:{trigger:"item",formatter:function(a){if(a.data.names.length>25){var e=[];for(var t=0;t<a.data.names.length;t++){if(t>=25&&t%25==0){e.push(a.data.names[t]+"<br />")}else{e.push(a.data.names[t])}}var r=e.join("");return a.seriesName+"<br />"+r+" ("+a.percent+"%)"}else{return a.seriesName+"<br />"+a.data.names+" ("+a.percent+"%)"}}},legend:{orient:"vertical",top:"middle",right:"18%",itemWidth:15,itemHeight:15,data:[]},series:[{name:"订阅设备",type:"pie",radius:["50%","70%"],avoidLabelOverlap:false,hoverAnimation:false,label:{normal:{show:true,position:"center",formatter:function(a,e,t,r){return a.seriesName}}},labelLine:{normal:{show:false}},center:["30%","50%"],data:[]}]};var p={title:{text:"",show:true,top:-50},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"rgba(0,0,0,0)"}},formatter:function(a,e,t,r){return'<div style="padding:0 20px 0 8px"><span>'+a[1].name+"</span><br/>"+"<span>"+a[1].marker+a[1].value+"%</span></div>"}},color:n,legend:{show:false,data:[]},grid:{left:"3%",bottom:"3%",containLabel:true},xAxis:{type:"value",boundaryGap:false},yAxis:[{type:"category",data:[]}],series:[{type:"bar",legendHoverLink:false,itemStyle:{normal:{color:"#ededed"}},barMaxWidth:10,silent:true,barGap:"-100%",data:["100","100","100","100"]},{name:"占用率",legendHoverLink:true,type:"bar",data:[],barMaxWidth:10,label:{normal:{position:"right",fontFamily:"FZLTHJW",fontSize:"14",formatter:function(a,e,t){return a.value+"%"}}}}]};var f=function(){var e={};e.chart=null;e.draw=function(r){a.ajax({url:$.path+"/api/sysMonitoring/getRealTimeTraffic",type:"post",success:function(n){var i=n.data[0].inputValueAxiss;var s=n.data[0].outputValueAxiss;var o=Math.max.apply(Math,i);var l=Math.max.apply(Math,s);var c=0,d="";if(o>l){for(;o>=1024;){o=o/1024;c++}}else{for(;l>=1024;){l=l/1024;c++}}i.forEach(function(a,e){for(var t=0;t<c;t++){a/=1024}i[e]=a});s.forEach(function(a,e){for(var t=0;t<c;t++){a/=1024}s[e]=a});if(c==1)d="KB";if(c==2)d="MB";if(c==3)d="GB";if(c==4)d="TB";u.yAxis.name="单位"+d;u.yAxis.min=0;u.yAxis.minInterval=1;u.yAxis.axisLabel={textStyle:{color:"#666"},formatter:function(a,e){return parseInt(a)}};u.xAxis.data=n.data[0].timeAxiss;u.series[0].data=i;u.series[1].data=s;if(r){e.chart=a.echarts({container:$("#chart1"),chartOption:u,echarts:t,drawCallback:function(){e.setInterval()}})}else{e.chart=a.echarts({container:$("#chart1"),echarts:t,chartOption:u})}}})};e.setInterval=function(){chartInterval=window.setInterval(function(){e.draw(false)},5e3)};e.draw(true)};var h=function(){var e={};e.chart=null;e.params={timeFlag:0};e.draw=function(r){a.ajax({url:$.path+"/api/sysMonitoring/getSubscriptionDeviceRanking",type:"get",params:e.params,success:function(r){var r=r.data;var n=[],i=[];for(var s in r){if(s&&s.indexOf("暂无")>-1){n.push(s);i.push({itemStyle:{normal:{color:"#d8d8d8"}},value:parseFloat(r[s]),name:s,names:s});d.color=["#d8d8d8"]}else{var o=s.slice(0,10);n.push(o);i.push({value:parseFloat(r[s]),name:o,names:s})}}d.legend.data=n;d.series[0].data=i;e.chart=a.echarts({container:$("#chart2"),chartOption:d,echarts:t})}})};e.setSwitch=function(){$("#p2 li").on("click",function(){var a=$(this).attr("type");switch(a){case"today":e.params.timeFlag=0;break;case"week":e.params.timeFlag=1;break}e.draw()})};e.draw();e.setSwitch()};var m=function(){var r={};r.chart=null;r.draw=function(i){a.ajax({url:$.path+"/api/sysMonitoring/getSystemusage",type:"get",success:function(s){var o=[];var l=s.data[0].name;var c=e.arrayStrToNumber(s.data[1].value);$(c).each(function(a,e){var t=(e*100).toFixed(2);o.push({value:t,label:{normal:{position:"right",show:true,color:n[a]}},itemStyle:{normal:{color:n[a]}}})});p.yAxis[0].data=l;p.series[1].data=o;if(i){r.chart=a.echarts({container:$("#chart3"),chartOption:p,echarts:t,drawCallback:function(){r.setInterval()}})}else{r.chart=a.echarts({container:$("#chart3"),echarts:t,chartOption:p})}}})};r.setInterval=function(){chartInterval2=window.setInterval(function(){r.draw(false)},7e3)};r.draw(true)};var g=function(){a.scroll({container:$(".ui-content")})};return{main:function(){f();h();c();m();e.setPanelButtonbar();e.setGridLinkGroup();self.setSwitch()}}});