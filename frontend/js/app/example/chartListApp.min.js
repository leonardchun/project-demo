define(["base","app/commonApp","echarts"],function(a,t,e){var r=["#04a0fa","#fa7e04"];var n=["#fa4f04","#5edb02","#02d2b2","#6b03e1"];var i=null;var o={processing:true,serverSide:true,searching:false,ordering:false,lengthChange:false,bPaginate:false,info:false,ajax:{url:"../json/grid1.json",type:"get",contentType:"application/json",data:function(a){var t={type1:$("#p3 .active").attr("type"),type2:$("#grid_status .active").attr("key")};if(t){$.extend(a,t)}return JSON.stringify(a)}},columns:[{data:"position",sWidth:"25%"},{data:"city",sWidth:"25%"},{data:"start_date",sWidth:"25%"},{data:"salary",sWidth:"25%"}]};var s=function(){var t={};i=a.datatables({container:$("#example"),option:o});a.scroll({container:$(".ui-panel-gridbar")});t.setSwitch=function(){$("#p3 li").on("click",function(){i.reload()});$("#grid_status li").on("click",function(){i.reload()})};t.setSwitch()};var c={color:r,legend:{right:10,data:[{name:"流入",textStyle:{color:r[0]}},{name:"流出",textStyle:{color:r[1]}}]},grid:{bottom:30,right:10,top:20},tooltip:{trigger:"axis",axisPointer:{animation:false}},xAxis:{type:"category",data:[],boundaryGap:false},yAxis:{type:"value",boundaryGap:[0,0],splitLine:{show:false}},series:[{name:"流入",type:"line",showSymbol:false,hoverAnimation:false,smooth:true,areaStyle:{normal:{opacity:.3}},data:[]},{name:"流出",type:"line",smooth:true,showSymbol:false,hoverAnimation:false,areaStyle:{normal:{opacity:.3}},data:[]}]};var l={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",x:"right",data:[]},series:[{name:"订阅设备",type:"pie",radius:["50%","70%"],avoidLabelOverlap:false,label:{normal:{show:false,position:"inner"},emphasis:{show:false,textStyle:{fontSize:"10",fontWeight:"bold"}}},labelLine:{normal:{show:false}},data:[]}]};var h={title:{text:"",show:true,top:-50},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},color:n,legend:{show:false,data:[]},grid:{top:40,left:"3%",right:"4%",bottom:0,containLabel:true},xAxis:{type:"value",boundaryGap:false},yAxis:[{type:"category",data:[]}],series:[{name:"占用率",type:"bar",data:[]}]};var u=function(){var r={};r.chart=null;r.draw=function(n){a.ajax({url:"../json/chart1.json",type:"get",success:function(i){var o=t.arrayStrToNumber(i.data[0].inputValueAxiss);var s=t.arrayStrToNumber(i.data[0].outputValueAxiss);c.xAxis.data=i.data[0].timeAxiss;c.series[0].data=o;c.series[1].data=s;if(n){r.chart=a.echarts({container:$("#chart1"),chartOption:c,echarts:e,drawCallback:function(){r.setInterval()}})}else{r.chart=a.echarts({container:$("#chart1"),echarts:e,chartOption:c})}}})};r.setInterval=function(){chartInterval=window.setInterval(function(){c.series[0].data.shift();c.series[1].data.shift();c.series[0].data.push(a.getRandom(1e4,18888));c.series[1].data.push(a.getRandom(1e4,18888));r.chart.refresh(c)},1e3)};r.draw(true)};var d=function(){var t={};t.chart=null;t.url="../json/chart2.json";t.params={};t.draw=function(r){a.ajax({url:t.url,type:"get",params:t.params,success:function(r){var n=[];$(r).each(function(a,t){n.push(t.name)});l.legend.data=n;l.series[0].data=r;t.chart=a.echarts({container:$("#chart2"),chartOption:l,echarts:e})}})};t.setSwitch=function(){$("#p2 li").on("click",function(){var a=$(this).attr("type");switch(a){case"today":t.url="../json/chart2.json";break;case"week":t.url="../json/chart2_week.json";break}t.draw()})};t.draw();t.setSwitch()};var p=function(){var r={};r.chart=null;r.draw=function(i){a.ajax({url:"../json/chart3.json",type:"get",success:function(o){var s=[];var c=o.data[0].name;var l=t.arrayStrToNumber(o.data[1].value);$(l).each(function(a,t){var e=(t*100).toFixed(2);s.push({value:e,label:{normal:{position:"right",show:true,color:n[a]}},itemStyle:{normal:{color:n[a]}}})});h.yAxis[0].data=c;h.series[0].data=s;if(i){r.chart=a.echarts({container:$("#chart3"),chartOption:h,echarts:e,drawCallback:function(){}})}else{r.chart=a.echarts({container:$("#chart3"),echarts:e,chartOption:h})}}})};r.setInterval=function(){chartInterval2=window.setInterval(function(){r.draw()},1e3)};r.draw(true)};var f=function(){a.scroll({container:$(".ui-content")})};return{main:function(){u();d();p();t.setPanelButtonbar();t.setGridLinkGroup();s()}}});