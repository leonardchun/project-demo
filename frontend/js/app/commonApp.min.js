define(["base","datatables","tree"],function(e){var a=10;var t={search:function(e){e.reload()},reset:function(a,t){e.form.reset(a,function(){if(t){t.reload()}})},checkByGridButton:function(e){if(e&&e.length>0){var a=$(e).filter(":checked");if(a.length==1){$(".ui-grid-buttonbar .modify").removeClass("disabled");$(".ui-grid-buttonbar .delete").removeClass("disabled")}else if(a.length>1){$(".ui-grid-buttonbar .modify").removeClass("disabled");$(".ui-grid-buttonbar .modify").addClass("disabled");$(".ui-grid-buttonbar .delete").removeClass("disabled")}else{$(".ui-grid-buttonbar .modify").removeClass("disabled");$(".ui-grid-buttonbar .modify").addClass("disabled");$(".ui-grid-buttonbar .delete").removeClass("disabled");$(".ui-grid-buttonbar .delete").addClass("disabled")}}},submit:function(a){var r=a.url?a.url:"";var i=a.params?a.params:null;var n=a.callback?a.callback:null;var o=a.type?a.type:"get";var l=a.position?a.position:"top";var s=e.requestTip({position:"center"});if(r){e.ajax({url:r,params:i,type:o,timeout:1e4,success:function(e){if(n){n()}switch(e.code){case"0":s.success(e.message);break;default:s.error(e.message);break}t.initButtonbar($(".ui-grid-buttonbar"))},beforeSend:function(){s.wait()},error:function(){s.error()}})}},setLocation:function(a,t){$(".ui-location ul").html("");var r={};var i=e.findParentToArray(a,t);if(i&&i.length>0){$(i).each(function(e,a){var t=document.createElement("li");$(t).html(a.label);$(".ui-location ul").append(t);if(e!=i.length-1){$(t).append("<i class='fa fa-angle-right'></i>")}})}},getStar:function(e){var a="";for(var t=1;t<=5;t++){if(t<=e){a+="<i class='light fa fa-star'></i>"}else{a+="<i class='fa fa-star'></i>"}}return a},loadPage:function(e){require(["app/mainApp"],function(a){a.loadPage(e)})},drawChart:function(a){var t={};t.chartContainer=a.chartContainer?a.chartContainer:null;t.chartOption=a.chartOption?a.chartOption:null;t.data=a.data?a.data:null;t.callback=a.callback?a.callback:null;t.draw=function(){t.setOption();e.highCharts({container:t.chartContainer,chartOption:t.chartOption,callback:t.callback})};t.setOption=function(){t.chartOption.series=t.data};t.draw()},arrayStrToNumber:function(e){var a=[];$(e).each(function(e,t){a.push(Number(t))});return a},setPanelButtonbar:function(){$(".ui-panel-buttonbar li").on("click",function(){$(this).parent().children("li").removeClass("active");$(this).addClass("active")})},setGridLinkGroup:function(){$(".ui-grid-linkGroup li").on("click",function(){$(this).parent().children("li").removeClass("active");$(this).addClass("active")})},mergeTreeData:function(e,a){var t={};var e=e;$(e).each(function(t,r){if(r.id==a){r.icon="../images/0.png";r.open=true;return true}else{var i=false;$(e).each(function(e,a){if(a.pid==r.id){r.icon="../images/2.png";r.open=true;i=true;return false}});if(i==false){r.icon="../images/4.png"}}});return e},gridFilter:function(a){var t=$.parseJSON(a);switch(t.code){case"0":t.recordsTotal=t.data.totalElements;t.recordsFiltered=t.data.totalElements;t.data=t.data.content;break;default:t.recordsTotal=0;t.recordsFiltered=0;t.data=[];var r=e.requestTip();r.error(t.message);break}return JSON.stringify(t)},gridPageFliter:function(e,t){e.page=e.start/e.length;e.size=t?t:a},getUserSession:function(e){e.setRequestHeader("Test","test")},getParams:function(a,r){t.gridPageFliter(a);var i=e.form.getParams($(r),true);if(i==""){i+="size="+a.size+"&page="+a.page}else{i+="&size="+a.size+"&page="+a.page}return i},getPostParams:function(a,r){t.gridPageFliter(a);var i=e.form.getParams($(r));if(i){$.extend(a,i)}return JSON.stringify(a)},initButtonbar:function(e){$(e).find(".add").show();$(e).find(".modify").removeClass("disabled").addClass("disabled");$(e).find(".delete").removeClass("disabled").addClass("disabled")},treeTable:function(a){var t={};t.tmpRow=null;t.dg=function(e){if(e&&e.length>0){$(e).each(function(e,r){var i=document.createElement("tr");$(i).attr("data-tt-id",r.id);$(i).attr("data-tt-parent-id",r.pid);$(i).addClass("ui-treeTableChild");var n="";$(a.aoColumns).each(function(e,a){var t=a.type?a.type:null;switch(t){case"checkbox":n+="<td><input type='checkbox' class='cb' name='cb' value='"+r[a.data]+"'/></td>";break;default:n+="<td>"+r[a.data]+"</td>";break}});$(i).html(n);$(t.tmpRow).after(i);t.tmpRow=i;t.dg(r.children)})}};var r=a.json.data;$(r).each(function(e,r){if(r.children&&r.children.length>0){t.tmpRow=$(a.nTable).find("tbody tr[rootrow='"+e+"']");t.dg(r.children)}});e.treeTable({container:a.nTable,setting:{expandable:true}})}};return t});